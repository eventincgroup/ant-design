{"version":3,"sources":["tree/DirectoryTree.jsx"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","React","classNames","omit","debounce","conductExpandParent","convertTreeToEntities","polyfill","ConfigConsumer","Tree","calcRangeKeys","getFullKeyList","convertDirectoryKeysToNodes","getFullKeyListByTreeData","Icon","getIcon","props","isLeaf","expanded","DirectoryTree","onExpand","expandedKeys","info","setUncontrolledState","undefined","onClick","event","node","expandAction","onDebounceExpand","onDoubleClick","onSelect","keys","multiple","children","state","nativeEvent","eventKey","newState","newEvent","selected","ctrlPick","ctrlKey","metaKey","shiftPick","shiftKey","newSelectedKeys","lastSelectedKey","cachedSelectedKeys","selectedNodes","Array","from","Set","selectedKeys","setTreeRef","tree","expandFolderNode","internalTree","onNodeExpand","setState","renderDirectoryTree","getPrefixCls","_a","customizePrefixCls","prefixCls","className","connectClassName","defaultExpandAll","defaultExpandParent","defaultExpandedKeys","keyEntities","defaultSelectedKeys","treeData","leading","nextProps","Component","defaultProps","showIcon"],"mappings":"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","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport debounce from 'lodash/debounce';\nimport { conductExpandParent, convertTreeToEntities } from 'rc-tree/lib/util';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { ConfigConsumer } from '../config-provider';\nimport Tree from './Tree';\nimport { calcRangeKeys, getFullKeyList, convertDirectoryKeysToNodes, getFullKeyListByTreeData, } from './util';\nimport Icon from '../icon';\nfunction getIcon(props) {\n    const { isLeaf, expanded } = props;\n    if (isLeaf) {\n        return <Icon type=\"file\"/>;\n    }\n    return <Icon type={expanded ? 'folder-open' : 'folder'}/>;\n}\nclass DirectoryTree extends React.Component {\n    constructor(props) {\n        super(props);\n        this.onExpand = (expandedKeys, info) => {\n            const { onExpand } = this.props;\n            this.setUncontrolledState({ expandedKeys });\n            // Call origin function\n            if (onExpand) {\n                return onExpand(expandedKeys, info);\n            }\n            return undefined;\n        };\n        this.onClick = (event, node) => {\n            const { onClick, expandAction } = this.props;\n            // Expand the tree\n            if (expandAction === 'click') {\n                this.onDebounceExpand(event, node);\n            }\n            if (onClick) {\n                onClick(event, node);\n            }\n        };\n        this.onDoubleClick = (event, node) => {\n            const { onDoubleClick, expandAction } = this.props;\n            // Expand the tree\n            if (expandAction === 'doubleClick') {\n                this.onDebounceExpand(event, node);\n            }\n            if (onDoubleClick) {\n                onDoubleClick(event, node);\n            }\n        };\n        this.onSelect = (keys, event) => {\n            const { onSelect, multiple, children } = this.props;\n            const { expandedKeys = [] } = this.state;\n            const { node, nativeEvent } = event;\n            const { eventKey = '' } = node.props;\n            const newState = {};\n            // We need wrap this event since some value is not same\n            const newEvent = Object.assign(Object.assign({}, event), { selected: true });\n            // Windows / Mac single pick\n            const ctrlPick = nativeEvent.ctrlKey || nativeEvent.metaKey;\n            const shiftPick = nativeEvent.shiftKey;\n            // Generate new selected keys\n            let newSelectedKeys;\n            if (multiple && ctrlPick) {\n                // Control click\n                newSelectedKeys = keys;\n                this.lastSelectedKey = eventKey;\n                this.cachedSelectedKeys = newSelectedKeys;\n                newEvent.selectedNodes = convertDirectoryKeysToNodes(children, newSelectedKeys);\n            }\n            else if (multiple && shiftPick) {\n                // Shift click\n                newSelectedKeys = Array.from(new Set([\n                    ...(this.cachedSelectedKeys || []),\n                    ...calcRangeKeys(children, expandedKeys, eventKey, this.lastSelectedKey),\n                ]));\n                newEvent.selectedNodes = convertDirectoryKeysToNodes(children, newSelectedKeys);\n            }\n            else {\n                // Single click\n                newSelectedKeys = [eventKey];\n                this.lastSelectedKey = eventKey;\n                this.cachedSelectedKeys = newSelectedKeys;\n                newEvent.selectedNodes = [event.node];\n            }\n            newState.selectedKeys = newSelectedKeys;\n            if (onSelect) {\n                onSelect(newSelectedKeys, newEvent);\n            }\n            this.setUncontrolledState(newState);\n        };\n        this.setTreeRef = (node) => {\n            this.tree = node;\n        };\n        this.expandFolderNode = (event, node) => {\n            const { isLeaf } = node.props;\n            if (isLeaf || event.shiftKey || event.metaKey || event.ctrlKey) {\n                return;\n            }\n            // Get internal rc-tree\n            const internalTree = this.tree.tree;\n            // Call internal rc-tree expand function\n            // https://github.com/ant-design/ant-design/issues/12567\n            internalTree.onNodeExpand(event, node);\n        };\n        this.setUncontrolledState = (state) => {\n            const newState = omit(state, Object.keys(this.props));\n            if (Object.keys(newState).length) {\n                this.setState(newState);\n            }\n        };\n        this.renderDirectoryTree = ({ getPrefixCls }) => {\n            const _a = this.props, { prefixCls: customizePrefixCls, className } = _a, props = __rest(_a, [\"prefixCls\", \"className\"]);\n            const { expandedKeys, selectedKeys } = this.state;\n            const prefixCls = getPrefixCls('tree', customizePrefixCls);\n            const connectClassName = classNames(`${prefixCls}-directory`, className);\n            return (<Tree icon={getIcon} ref={this.setTreeRef} {...props} prefixCls={prefixCls} className={connectClassName} expandedKeys={expandedKeys} selectedKeys={selectedKeys} onSelect={this.onSelect} onClick={this.onClick} onDoubleClick={this.onDoubleClick} onExpand={this.onExpand}/>);\n        };\n        const { defaultExpandAll, defaultExpandParent, expandedKeys, defaultExpandedKeys, children, } = props;\n        const { keyEntities } = convertTreeToEntities(children);\n        // Selected keys\n        this.state = {\n            selectedKeys: props.selectedKeys || props.defaultSelectedKeys || [],\n        };\n        // Expanded keys\n        if (defaultExpandAll) {\n            if (props.treeData) {\n                this.state.expandedKeys = getFullKeyListByTreeData(props.treeData);\n            }\n            else {\n                this.state.expandedKeys = getFullKeyList(props.children);\n            }\n        }\n        else if (defaultExpandParent) {\n            this.state.expandedKeys = conductExpandParent(expandedKeys || defaultExpandedKeys, keyEntities);\n        }\n        else {\n            this.state.expandedKeys = expandedKeys || defaultExpandedKeys;\n        }\n        this.onDebounceExpand = debounce(this.expandFolderNode, 200, {\n            leading: true,\n        });\n    }\n    static getDerivedStateFromProps(nextProps) {\n        const newState = {};\n        if ('expandedKeys' in nextProps) {\n            newState.expandedKeys = nextProps.expandedKeys;\n        }\n        if ('selectedKeys' in nextProps) {\n            newState.selectedKeys = nextProps.selectedKeys;\n        }\n        return newState;\n    }\n    render() {\n        return <ConfigConsumer>{this.renderDirectoryTree}</ConfigConsumer>;\n    }\n}\nDirectoryTree.defaultProps = {\n    showIcon: true,\n    expandAction: 'click',\n};\npolyfill(DirectoryTree);\nexport default DirectoryTree;\n"],"file":"DirectoryTree.js"}